doctype html
html(lang="vi")
  head
    meta(charset="UTF-8")
    meta(name="viewport" content="width=device-width, initial-scale=1.0")
    title #{title}
    link(href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet")
    link(rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css")
    link(rel="stylesheet" href="/style/in.css")
  body
    header.page-header
      .container
        h1.text-center.mb-0 Nhận Diện Biển Số Xe
        p.text-center.mb-0.mt-1 Hệ thống nhận diện biển số xe tự động

    .container.main-content
      .row
        .col-lg-6
          .card.h-100
            .card-header
              i.bi.bi-camera-fill.me-2
              | Tải lên hình ảnh
            .card-body
              form(action="/upload" method="POST" enctype="multipart/form-data")
                .mb-3
                  label.form-label(for="imageInput") Chọn hình ảnh xe
                  input#imageInput.form-control(type="file" name="image" accept="image/*" required)
                  .form-text Hỗ trợ các định dạng: JPG, PNG, JPEG, ...
                
                .preview-container
                  .preview-placeholder
                    i.bi.bi-image.upload-icon.d-block
                    p Xem trước hình ảnh sẽ hiển thị ở đây
                
                .d-grid.gap-2.mt-3
                  button.btn.btn-primary(type="submit")
                    i.bi.bi-search.me-2
                    | Nhận Diện Biển Số
              
              if error
                .alert.alert-danger.mt-3
                  i.bi.bi-exclamation-triangle-fill.me-2
                  | #{error}

        .col-lg-6
          .result-container(class=showResults ? 'show' : '')
            .card.h-100
              .card-header
                i.bi.bi-check-circle-fill.me-2
                | Kết Quả Nhận Diện
              .card-body
                if showResults && imageBase64
                  .result-image-container
                    img.img-fluid.rounded(src=`data:image/jpeg;base64,${imageBase64}` alt="Hình ảnh đã nhận diện")
                  
                  if detections && detections.detection_case
                    if detections.detection_case == 1
                      .alert.alert-success
                        h5.mb-2
                          i.bi.bi-card-list.me-2
                          | Biển số được phát hiện:
                        
                        each lp in detections.license_plates
                          .license-plate-item #{lp}

                    else if detections.detection_case == 2
                       .alert.alert-warning
                          i.bi.bi-exclamation-triangle-fill.me-2
                          | Không thể trích xuất thông tin biển số

                    else if detections.detection_case == 3
                      .alert.alert-danger
                          i.bi.bi-x-circle-fill.me-2
                          | Không phát hiện biển số nào trong hình ảnh
                else
                  .result-placeholder
                    i.bi.bi-file-earmark-text
                    p Kết quả nhận diện sẽ hiển thị ở đây sau khi tải lên hình ảnh

    footer.footer
      .container
        p.mb-0 &copy; 2025 Hệ thống Nhận Diện Biển Số Xe

    script(src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js")
    script(src="js/in.js")
